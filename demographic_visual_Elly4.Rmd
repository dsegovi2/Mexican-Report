---
title: "Mexican Report"
author: "Demographic"
date: "Great Cities Institute"
output: 
  pdf_document:
    latex_engine: xelatex
    toc: true
    highlight: pygments
    extra_dependencies: ["float"]
    fig_caption: true
mainfont: "Arial"
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = F, warning = F, fig.pos="H")


```


```{r echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}

library(ipumsr)
library(tidyverse)
library(purrr)
library(sf)
library(tidycensus)
library(tidyr)
library(readxl)
library(sf)
library(htmltools)
library(leaflet)
library(janitor)
library(data.table)
library(tinytex)
library(survey) # for survey analysis
library(srvyr)  # for tidy survey analysis
library(tmap)
library("kableExtra") 
library(tmaptools)
library("RColorBrewer") 
library(janitor)
# library(OpenStreetMap)
# remotes::install_github('yihui/knitr')
# install.packages("knitr")
# library(knitr)
# options(tinytex.verbose = TRUE)
# tinytex::reinstall_tinytex()
# install.packages('tinytex')

# update.packages(ask = FALSE, checkBuilt = TRUE)
# tinytex::tlmgr_update()
# tinytex::latexmk("demographic_visual.tex")


##### Chicago boarder
Chicago_boundary_shp <- read_sf("C:/Users/elhamp2/Box/Great Cities Institute/Research/Mexican Report/Boundaries_Chicago/geo_export_8881adc5-2460-457b-892f-04f4d6028b72.shp") %>% 
  st_transform(crs = 4326)
# mapview(community_shp)

# Get the current bounding box of the data
bbox_data <- st_bbox(Chicago_boundary_shp)

# Calculate the range of x and y values in degrees
xrange <- bbox_data$xmax - bbox_data$xmin
yrange <- bbox_data$ymax - bbox_data$ymin

# Calculate the center of the bounding box
center_x <- (bbox_data$xmin + bbox_data$xmax) / 2
center_y <- (bbox_data$ymin + bbox_data$ymax) / 2
# Modify the bounding box to fit the desired width while keeping the height the same
bbox_new <- c(center_x - 0.24,
              center_y - 0.23,
              center_x + 0.23,
              center_y + 0.23)

# osm_chicago <- read_osm(bbox_new, 
#                         type = "bing")

# ####### 2018-2022 ##################
# comm_2022 <- st_read("Data Tables/shp/comm_pop_chi_2022.shp") %>% 
#   mutate(lable_prc = paste0(lable, ": ", prc_mxc),
#          prc2 = paste0( prc_mxc, "%")) %>% 
#   mutate(ttl_mxc2 = scales::comma(ttl_mxc)) %>% 
#   rename(prc = prc_mxc) %>%
#   mutate(year = "2018-2022") %>% 
#   select(year, commnty, lable, ttl_mxc, ttl_mxc2, prc, geometry)
# 
# tract_2022 <- st_read("Data Tables/shp/tract_pop_chi_2022.shp") 
# 
# pop_dots_2022_origin_50 <- read_sf("Data Tables/shp/pop_dots_2022_origin_50.shp") 
# 
# ####### 2010 ######################
# comm_2012 <- st_read("Data Tables/shp/comm_pop_chi_2012.shp") %>%
#   mutate(lable_prc = paste0(lable, ": ", prc)) %>% 
#   mutate(ttl_mxc2 = scales::comma(ttl_mxc)) %>% 
#   mutate(year = "2010") %>% 
#   select(year, commnty, lable, ttl_mxc, ttl_mxc2, prc, geometry)
# 
# tract_2012 <- st_read("Data Tables/shp/tract_pop_chi_2012.shp")
# 
# pop_dots_2010_origin_50 <- read_sf("Data Tables/shp/pop_dots_2010_origin_50.shp") 
# 
# ####### 2000 ######################
# comm_2000 <- st_read("Data Tables/shp/comm_pop_chi_2000.shp") %>%
#   mutate(lable_prc = paste0(lable, ": ", prc)) %>% 
#   mutate(ttl_mxc2 = scales::comma(ttl_mxc)) %>% 
#   mutate(year = "2000") %>% 
#   select(year, commnty, lable, ttl_mxc, ttl_mxc2, prc, geometry)
# 
# tract_2000 <- st_read("Data Tables/shp/tract_pop_chi_2000.shp")
# 
# pop_dots_2000_origin_50 <- read_sf("Data Tables/shp/pop_dots_2000_origin_50.shp")
# 
# ####### Combine data
# comm_2000_2022 <- rbind(comm_2022, comm_2012,  comm_2000)
### st_write(comm_2000_2022, "Data Tables/shp/comm_pop_chi_2000_2022.shp" )
comm_2000_2022 <- st_read ("Data Tables/shp/comm_pop_chi_2000_2022.shp" ) %>% 
  mutate(prc2 = paste0(format(round(prc, 1), nsmall = 1), "%")) %>% 
  mutate(prc = round(prc, 1)) %>% 
  # mutate(lable_prc = paste0(lable, ": ", prc)) %>% 
  # mutate(lable_pop = paste0(lable, ": ", ttl_mxc2)) %>% 
  mutate(comm_prc_label = paste0(str_to_title(tolower(commnty)), ":\n", prc2)) %>% 
  mutate(comm_pop_label = paste0(str_to_title(tolower(commnty)), ":\n", ttl_mxc2))
``` 

\renewcommand{\arraystretch}{1.4}


# Demographic

## 1A.1: Mexican population in Chicago, 2000 to 2018-2022:

\clearpage

### Mexican Population by Community Areas in Chicago, 2018-2022


```{r fig.height=11, fig.width=8}

comm_mexican_pop_map_2022 <-

  tm_shape(comm_2000_2022 %>% filter(year == "2018-2022"), bbox = bbox_new) +
  tm_polygons(
    col = "ttl_mxc",
    breaks = c(0, 15000, 30000, 45000, 60000, 75000),
    border.col = "#6c757d",
              palette="Blues",
              alpha = 1,
              # n = 5,
              title = "Mexican Population",
              lwd = 0.3,
    legend.show = FALSE
    ) +
 
   tm_text("ttl_mxc2" , size = 0.7, alpha = 0.9, fontface="bold", fontfamily = "sans") +

  
  tm_shape(comm_2000_2022 %>% filter(prc>=50 & year == "2018-2022")) +
  tm_borders(col = "#9b2226",
             alpha = 1,
             lwd = 2) +


  tm_shape(Chicago_boundary_shp) +
  tm_borders(col = "#343a40",
             alpha = 1,
             lwd = 2.5) +

  tm_layout( frame = TRUE,
             # main.title.position = c("left", "top"),
             # main.title = "Density of Hispanic or Latino Population by their Origins in Chicago, 2010",
             # main.title.size = 1.2,
            legend.outside = FALSE,
            legend.width = 1.5,
            legend.title.size = .9,
            legend.text.size = 0.8,
            legend.title.fontface = "bold",
            # legend.position = c("left", "bottom"),
            legend.position = c(0.03, 0.12),
            legend.bg.color = "white",
            legend.bg.alpha = .3) +      # manually position legend) +
  
  tm_credits("Data Source: IPUMS NHGIS, University of Minnesota, www.nhgis.org\n(2018-2022 American Community Survey 5-year Estimates).\nTabulations by Great Cities Institute. ",
             fontface = "bold",
             position = c("left","bottom"), size = 0.8)+


  tm_credits("Mexican Population by Community Area in Chicago,\n2018-2022 (ACS 5-year Estimates)",
             fontface = "bold",
             position = c("left","top"), size = 1.25) +
  
  tm_add_legend("fill", 
                labels = c("0 - 15,000", "15,001 - 30,000", "30,001 - 45,000", "45,001 - 60,000", "60,001 - 75,000"), 
                col = c("#eff3ff", "#bdd7e7", "#6baed6", "#3182bd", "#08519c"),
                alpha = 1,
                lwd = .3,

                border.col = "#ced4da",
                title = "Mexican Population",
                size = 0.7) +
  
  tm_add_legend("line",
                labels = c("Chicago", "Community Areas", "" ,"Community Areas with More Than\n50% Share of Mexican Population", ""),
                col = c("#343a40" , "#6c757d" , "white","#9b2226", "white"),
                lwd = c(2.5, 2, 2.5, 2.5,2.5),
                title = "",
                size = 0.8) +

  tm_compass(position = c("right", "bottom"), size = 1) +
  tm_scale_bar(position = c("right", "bottom"), width = 0.15)

comm_mexican_pop_map_2022

```


### Mexican Population by Community Areas in Chicago, 2010


```{r fig.height=11, fig.width=8}

comm_mexican_pop_map_2010 <-

  tm_shape(comm_2000_2022 %>% filter(year == "2010"), bbox = bbox_new) +
  tm_polygons(
    col = "ttl_mxc",
    breaks = c(0, 15000, 30000, 45000, 60000, 75000),
    border.col = "#6c757d",
              palette="Blues",
              alpha = 1,
              # n = 5,
              title = "Mexican Population",
              lwd = 0.3,
    legend.show = FALSE
    ) +
 
   tm_text("ttl_mxc2" , size = 0.7, alpha = 0.9, fontface="bold", fontfamily = "sans") +

  
  tm_shape(comm_2000_2022 %>% filter(prc>=50 & year == "2010")) +
  tm_borders(col = "#9b2226",
             alpha = 1,
             lwd = 2) +


  tm_shape(Chicago_boundary_shp) +
  tm_borders(col = "#343a40",
             alpha = 1,
             lwd = 2.5) +

  tm_layout( frame = TRUE,
             # main.title.position = c("left", "top"),
             # main.title = "Density of Hispanic or Latino Population by their Origins in Chicago, 2010",
             # main.title.size = 1.2,
            legend.outside = FALSE,
            # legend.width = 1.5,
            legend.title.size = .9,
            legend.text.size = 0.8,
            legend.title.fontface = "bold",
            # legend.position = c("left", "bottom"),
            legend.position = c(0.03, 0.12),
            legend.bg.color = "white",
            legend.bg.alpha = .3) +      # manually position legend) +
  
  tm_credits("Data Source: IPUMS NHGIS, University of Minnesota, www.nhgis.org \n(2010 Decennial Censuses).\nTabulations by Great Cities Institute. ",
             fontface = "bold",
             position = c("left","bottom"), size = 0.8)+


  tm_credits("Mexican Population by Community Area in Chicago,\n2010 (Decennial Census)",
             fontface = "bold",
             position = c("left","top"), size = 1.25) +
  
  tm_add_legend("fill", 
                labels = c("0 - 15,000", "15,001 - 30,000", "30,001 - 45,000", "45,001 - 60,000", "60,001 - 75,000"), 
                col = c("#eff3ff", "#bdd7e7", "#6baed6", "#3182bd", "#08519c"),
                alpha = 1,
                lwd = .3,

                border.col = "#ced4da",
                title = "Mexican Population",
                size = 0.7) +
  
  tm_add_legend("line",
                labels = c("Chicago", "Community Areas", "" ,"Community Areas with More Than\n50% Share of Mexican Population", ""),
                col = c("#343a40" , "#6c757d" , "white","#9b2226", "white"),
                lwd = c(2.5, 2, 2.5, 2.5,2.5),
                title = "",
                size = 0.8) +

  tm_compass(position = c("right", "bottom"), size = 1) +
  tm_scale_bar(position = c("right", "bottom"), width = 0.15)

comm_mexican_pop_map_2010

```


### Mexican Population by Community Areas in Chicago, 2000


```{r fig.height=11, fig.width=8}

comm_mexican_pop_map_2000 <-

  tm_shape(comm_2000_2022 %>% filter(year == "2000"), bbox = bbox_new) +
  tm_polygons(
    col = "ttl_mxc",
    breaks = c(0, 15000, 30000, 45000, 60000, 75000),
    border.col = "#6c757d",
              palette="Blues",
              alpha = 1,
              # n = 5,
              title = "Mexican Population",
              lwd = 0.3,
    legend.show = FALSE
    ) +
 
   tm_text("ttl_mxc2" , size = 0.7, alpha = 0.9, fontface="bold", fontfamily = "sans") +

  
  tm_shape(comm_2000_2022 %>% filter(prc>=50 & year == "2000")) +
  tm_borders(col = "#9b2226",
             alpha = 1,
             lwd = 2) +


  tm_shape(Chicago_boundary_shp) +
  tm_borders(col = "#343a40",
             alpha = 1,
             lwd = 2.5) +

  tm_layout( frame = TRUE,
             # main.title.position = c("left", "top"),
             # main.title = "Density of Hispanic or Latino Population by their Origins in Chicago, 2010",
             # main.title.size = 1.2,
            legend.outside = FALSE,
            # legend.width = 1.5,
            legend.title.size = .9,
            legend.text.size = 0.8,
            legend.title.fontface = "bold",
            # legend.position = c("left", "bottom"),
            legend.position = c(0.03, 0.12),
            legend.bg.color = "white",
            legend.bg.alpha = .3) +      # manually position legend) +
  
  tm_credits("Data Source: IPUMS NHGIS, University of Minnesota, www.nhgis.org \n(2000 Decennial Censuses).\nTabulations by Great Cities Institute. ",
             fontface = "bold",
             position = c("left","bottom"), size = 0.8)+


  tm_credits("Mexican Population by Community Area in Chicago,\n2000 (Decennial Census)",
             fontface = "bold",
             position = c("left","top"), size = 1.25) +
  
  tm_add_legend("fill", 
                labels = c("0 - 15,000", "15,001 - 30,000", "30,001 - 45,000", "45,001 - 60,000", "60,001 - 75,000"), 
                col = c("#eff3ff", "#bdd7e7", "#6baed6", "#3182bd", "#08519c"),
                alpha = 1,
                lwd = .3,

                border.col = "#ced4da",
                title = "Mexican Population",
                size = 0.7) +
  
  tm_add_legend("line",
                labels = c("Chicago", "Community Areas", "" ,"Community Areas with More Than\n50% Share of Mexican Population", ""),
                col = c("#343a40" , "#6c757d" , "white","#9b2226", "white"),
                lwd = c(2.5, 2, 2.5, 2.5,2.5),
                title = "",
                size = 0.8) +

  tm_compass(position = c("right", "bottom"), size = 1) +
  tm_scale_bar(position = c("right", "bottom"), width = 0.15)

comm_mexican_pop_map_2000

```



## Percentage of the Mexican Population, 2000 to 2018-2022

### Percentage of the Mexican Population by Community Areas in Chicago, 2018-2022

```{r fig.height=11, fig.width=8}
# fig.height=11, fig.width=24
comm_mexican_prc_map_2022 <-

  tm_shape(comm_2000_2022 %>% filter(year == "2018-2022"), bbox = bbox_new) +
  tm_polygons(
    col = "prc",
              # style = "jenks",
              border.col = "#6c757d",
              palette="Blues",
              alpha = 1,
              # n = 5,
    breaks = c(0, 20.1, 40.1, 60.1, 80.1, 100),
    legend.show = FALSE,
              title = "Percentage",
              lwd = 0.3) +
   tm_text("prc2" , size = 0.65, alpha = 1, fontface="bold", fontfamily = "sans")+

  tm_shape(Chicago_boundary_shp) +
  tm_borders(col = "#343a40",
             alpha = 1,
             lwd = 2.5) +
  

   tm_layout( frame = TRUE,
             # main.title.position = c("left", "top"),
             # main.title = "Density of Hispanic or Latino Population by their Origins in Chicago, 2010",
             # main.title.size = 1.2,
            legend.outside = FALSE,
            # legend.width = 1.5,
            legend.title.size = .9,
            legend.text.size = 0.8,
            legend.title.fontface = "bold",
            # legend.position = c("left", "bottom"),
            legend.position = c(0.03, 0.12),
            legend.bg.color = "white",
            legend.bg.alpha = .3) + 
  
  tm_credits("Percent Mexican Population by Community Area in Chicago,\n2018-2022 (ACS 5-year Estimates) ",
             fontface = "bold",
             position = c("left","top"), size = 1.25) +
  
  
  tm_credits("Data Source: IPUMS NHGIS, University of Minnesota, www.nhgis.org\n(2018-2022 American Community Survey 5-year Estimates).\nTabulations by Great Cities Institute. ",
             fontface = "bold",
             position = c("left","bottom"), size = 0.8)+
  
  
  tm_add_legend("fill", 
                labels = c("0.0% - 20.0%", "20.1% - 40.0%", "40.1% - 60.0%", "60.1% - 80.0%", "80.1% - 100%"), 
                col = c("#eff3ff", "#bdd7e7", "#6baed6", "#3182bd", "#08519c"),
                alpha = 1,
                lwd = .3,

                border.col = "#ced4da",
                title = "Percent",
                size = 0.7)+
  
  tm_add_legend("line",
                labels = c("Chicago", "Community Areas"),
                col = c("#343a40","#6c757d"),
                lwd = c(2.5, 2),
                title = "",
                size = 0.8) 
  

  


comm_mexican_prc_map_2022

```



### Percentage of the Mexican Population by Community Areas in Chicago, 2010

```{r fig.height=11, fig.width=8}
# fig.height=11, fig.width=24
comm_mexican_prc_map_2010 <-

  tm_shape(comm_2000_2022 %>% filter(year == "2010"), bbox = bbox_new) +
  tm_polygons(
    col = "prc",
              # style = "jenks",
              border.col = "#6c757d",
              palette="Blues",
              alpha = 1,
              # n = 5,
    breaks = c(0, 20.1, 40.1, 60.1, 80.1, 100),
    legend.show = FALSE,
              title = "Percentage",
              lwd = 0.3) +
   tm_text("prc2" , size = 0.65, alpha = 1, fontface="bold", fontfamily = "sans")+

  tm_shape(Chicago_boundary_shp) +
  tm_borders(col = "#343a40",
             alpha = 1,
             lwd = 2.5) +
  

   tm_layout( frame = TRUE,
             # main.title.position = c("left", "top"),
             # main.title = "Density of Hispanic or Latino Population by their Origins in Chicago, 2010",
             # main.title.size = 1.2,
            legend.outside = FALSE,
            # legend.width = 1.5,
            legend.title.size = .9,
            legend.text.size = 0.8,
            legend.title.fontface = "bold",
            # legend.position = c("left", "bottom"),
            legend.position = c(0.03, 0.12),
            legend.bg.color = "white",
            legend.bg.alpha = .3) + 
  
  tm_credits("Percent Mexican Population by Community Area in Chicago,\n  2010  (Decennial Census) ",
             fontface = "bold",
             position = c("left","top"), size = 1.25) +
  
  
  tm_credits("Data Source: IPUMS NHGIS, University of Minnesota, www.nhgis.org \n(2010 Decennial Census),\nTabulations by Great Cities Institute. ",
             fontface = "bold",
             position = c("left","bottom"), size = 0.8)+
  
  
  tm_add_legend("fill", 
                labels = c("0.0% - 20.0%", "20.1% - 40.0%", "40.1% - 60.0%", "60.1% - 80.0%", "80.1% - 100%"), 
                col = c("#eff3ff", "#bdd7e7", "#6baed6", "#3182bd", "#08519c"),
                alpha = 1,
                lwd = .3,

                border.col = "#ced4da",
                title = "Percent",
                size = 0.7)+
  
  tm_add_legend("line",
                labels = c("Chicago", "Community Areas"),
                col = c("#343a40","#6c757d"),
                lwd = c(2.5, 2),
                title = "",
                size = 0.8) 
  

  


comm_mexican_prc_map_2010

```



### Percentage of the Mexican Population by Community Areas in Chicago, 2000

```{r fig.height=11, fig.width=8}
# fig.height=11, fig.width=24
comm_mexican_prc_map_2000 <-

  tm_shape(comm_2000_2022 %>% filter(year == "2000"), bbox = bbox_new) +
  tm_polygons(
    col = "prc",
              # style = "jenks",
              border.col = "#6c757d",
              palette="Blues",
              alpha = 1,
              # n = 5,
    breaks = c(0, 20.1, 40.1, 60.1, 80.1, 100),
    legend.show = FALSE,
              title = "Percentage",
              lwd = 0.3) +
   tm_text("prc2" , size = 0.65, alpha = 1, fontface="bold", fontfamily = "sans")+

  tm_shape(Chicago_boundary_shp) +
  tm_borders(col = "#343a40",
             alpha = 1,
             lwd = 2.5) +
  

   tm_layout( frame = TRUE,
             # main.title.position = c("left", "top"),
             # main.title = "Density of Hispanic or Latino Population by their Origins in Chicago, 2010",
             # main.title.size = 1.2,
            legend.outside = FALSE,
            # legend.width = 1.5,
            legend.title.size = .9,
            legend.text.size = 0.8,
            legend.title.fontface = "bold",
            # legend.position = c("left", "bottom"),
            legend.position = c(0.03, 0.12),
            legend.bg.color = "white",
            legend.bg.alpha = .3) + 
  
  tm_credits("Percent Mexican Population by Community Area in Chicago,\n2000 (Decennial Census) ",
             fontface = "bold",
             position = c("left","top"), size = 1.25) +
  
  
  tm_credits("Data Source: IPUMS NHGIS, University of Minnesota, www.nhgis.org \n(2000 Decennial Census),\nTabulations by Great Cities Institute. ",
             fontface = "bold",
             position = c("left","bottom"), size = 0.8)+
  
  
  tm_add_legend("fill", 
                labels = c("0.0% - 20.0%", "20.1% - 40.0%", "40.1% - 60.0%", "60.1% - 80.0%", "80.1% - 100%"), 
                col = c("#eff3ff", "#bdd7e7", "#6baed6", "#3182bd", "#08519c"),
                alpha = 1,
                lwd = .3,

                border.col = "#ced4da",
                title = "Percent",
                size = 0.7)+
  
  tm_add_legend("line",
                labels = c("Chicago", "Community Areas"),
                col = c("#343a40","#6c757d"),
                lwd = c(2.5, 2),
                title = "",
                size = 0.8) 
  

  


comm_mexican_prc_map_2000

```

## Community Areas in Chicago, 2000

```{r fig.height=11, fig.width=8}
# fig.height=11, fig.width=24
Community_areas <-

  tm_shape(comm_2000_2022 %>% filter(year == "2018-2022"), bbox = bbox_new) +
  tm_polygons(
    col = "#ced4da",
              # border.col = "#6c757d",
              alpha = 0.3,
    legend.show = FALSE) +
  tm_borders(col = "#6c757d",
             alpha = 0.8,
             lwd = 0.3) +
  tm_text("lable" , size = 0.6, alpha = 1, fontface="bold", fontfamily = "sans") +
   

  tm_shape(Chicago_boundary_shp) +
  tm_borders(col = "#343a40",
             alpha = 1,
             lwd = 2.5) +
  
  

   tm_layout( frame = TRUE,
             # main.title.position = c("left", "top"),
             # main.title = "Density of Hispanic or Latino Population by their Origins in Chicago, 2010",
             # main.title.size = 1.2,
            legend.outside = FALSE,
            # legend.width = 1.5,
            legend.title.size = .9,
            legend.text.size = 0.8,
            legend.title.fontface = "bold",
            # legend.position = c("left", "bottom"),
            legend.position = c(0.03, 0.12),
            legend.bg.color = "white",
            legend.bg.alpha = .3) + 
  
  tm_credits("Community Areas in Chicago",
             fontface = "bold",
             position = c("left","top"), size = 1.25) +
  
  
  tm_credits("Data Source: City of Chicago Data Portal,\nTabulations by Great Cities Institute. ",
             fontface = "bold",
             position = c("left","bottom"), size = 0.8)+
  
  
  tm_add_legend("fill", 
                labels = c("Community Areas"), 
                col = c("#ced4da"),
                alpha = 0.5,
                lwd = .3,

                border.col = "#6c757d",
                title = "",
                size = 0.7)+
  
  tm_add_legend("line",
                labels = c("Chicago"),
                col = c("#343a40"),
                lwd = c(2.5),
                title = "",
                size = 0.8) 
 

Community_areas

```

## Industry Area


![image1](Data Tables\MexicansChicago_IndustrialCorridors.png)

